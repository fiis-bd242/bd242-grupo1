# 10.4. Flujo de Operaciones
## Módulo 3
### Proceso batch 1:
1. **Inicio**
2. Obtener todas las vacantes
3. Iterar sobre cada vacante
   - Si la fecha fin es menor a la fecha actual:
     - Si el estado es "Abierta":
       - Actualizar estado a "Cerrada"
       - Guardar vacante actualizada
4. **Fin**
### Proceso batch 2:
1. **Inicio**
2. Obtener todas las convocatorias
3. Iterar sobre cada convocatoria
   - Si la fecha fin es menor a la fecha actual:
     - Si el estado no es "cerrada":
       - Actualizar estado a "cerrada"
       - Guardar convocatoria actualizada
4. **Fin**

## Módulo 4

### Proceso batch 1:
#### **1. Extracción de Datos**
Se realiza la extracción de datos desde las fuentes primarias (tablas de entrada) para consolidar la información relevante.

- **Operaciones:**
  - Extraer los datos de las tablas:
    - `Ventas`
    - `Clientes`
    - `Productos`
    - `Regiones`
  - Validar la calidad de los datos:
    - Asegurar que no haya valores nulos o inconsistencias en claves foráneas.

#### **2. Transformación de Datos**
Se aplica la lógica de negocio para estructurar y calcular las métricas necesarias.

- **Operaciones:**
  1. **Calcular Ventas Totales por Región:**
     - Realizar un join entre `Ventas` y `Regiones` por `id_region`.
     - Agrupar por `id_region`.
     - Sumar el monto de las ventas por región.

  2. **Clasificar Clientes por Segmento:**
     - Realizar un join entre `Ventas` y `Clientes` por `id_cliente`.
     - Agrupar clientes por segmentos (`Corporativo`, `Individual`, etc.).
     - Contar y sumar montos asociados a cada segmento.

  3. **Productos Más Vendidos:**
     - Realizar un join entre `Ventas` y `Productos` por `id_producto`.
     - Agrupar por `id_producto`.
     - Contar la cantidad de unidades vendidas y calcular los ingresos.

  4. **Análisis de Tendencias:**
     - Crear un campo temporal (`mes_año`) a partir de las fechas de venta.
     - Agrupar ventas por `mes_año` para detectar tendencias mensuales.


#### **3. Carga de Tablas Temporales**
Se almacenan los resultados intermedios en tablas temporales para optimizar los pasos siguientes.

- **Tablas Temporales Generadas:**
  1. **Ventas Totales por Región**
  2. **Clientes por Segmento**
  3. **Productos Más Vendidos**
  4. **Tendencias de Ventas**

#### **4. Generación de Tablas de Salida**
Se consolidan las métricas y resultados finales en las tablas para el reporte business.

- **Operaciones:**
  1. **Reporte de Desempeño Regional:**
     - Integrar ventas totales y segmentación de clientes por región.
  2. **Ranking de Productos:**
     - Ordenar los productos más vendidos con base en cantidad de unidades y monto total.
  3. **Análisis Temporal:**
     - Generar una tabla que muestre ventas por mes y año para cada región.
  4. **Resumen de Segmentos:**
     - Mostrar la distribución de ingresos y clientes por segme
### Proceso batch 2:
#### **1. Extracción de Datos**
Se realiza la extracción de datos desde las fuentes primarias (tablas de entrada) para obtener la información relevante.

- **Operaciones:**
  - Extraer los datos de las tablas:
    - `Tickets`
    - `Analistas`
    - `Clientes`
  - Validar la integridad de los datos (valores nulos, duplicados, formatos correctos).

#### **2. Transformación de Datos**
Se aplican las operaciones necesarias para calcular las métricas y estructurar los datos intermedios.

- **Operaciones:**
  1. **Calcular Tickets por Analista:**
     - Agrupar tickets por `id_analista`.
     - Contar la cantidad de tickets por analista.

  2. **Calcular Tiempo de Resolución:**
     - Crear la columna `tiempo_resolucion`:
       - `tiempo_resolucion = fecha_resolucion - fecha_creacion`.
     - Calcular el promedio de tiempo por analista.

  3. **Analizar Estados de Tickets:**
     - Agrupar por `id_analista` y `estado`.
     - Contar tickets en cada estado (`Activo`, `Resuelto`, etc.).

  4. **Segmento de Clientes Atendidos:**
     - Realizar un join entre las tablas `Tickets` y `Clientes` por `id_cliente`.
     - Agrupar por `id_analista` y `segmento`.
     - Contar la cantidad de clientes atendidos en cada segmento.

#### **3. Carga de Tablas Temporales**
Se almacenan los resultados intermedios en tablas temporales para facilitar el procesamiento posterior.

- **Tablas Temporales Generadas:**
  1. **Tickets por Analista**
  2. **Tiempo de Resolución**
  3. **Estado de Tickets por Analista**
  4. **Segmento de Clientes Atendidos`

#### **4. Generación de Tablas de Salida**
Se consolidan los datos y se generan las tablas finales del reporte.

- **Operaciones:**
  1. **Desempeño por Analista:**
     - Integrar datos de tickets atendidos, tiempo promedio, y estados.
  2. **Análisis de Segmentos Atendidos:**
     - Calcular porcentajes por segmento.
  3. **Ranking de Analistas:**
     - Crear un puntaje basado en:
       - Tickets atendidos.
       - Tiempo promedio de resolución.
       - Diversidad de segmentos.
     - Ordenar analistas por puntaje para generar un ranking.

---
